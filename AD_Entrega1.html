<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Marc Arrom Esquembre">
<meta name="dcterms.date" content="2024-09-16">

<title>Análisis del Impacto del Mieloma Múltiple en los Niveles de Hemoglobina</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="AD_Entrega1_files/libs/clipboard/clipboard.min.js"></script>
<script src="AD_Entrega1_files/libs/quarto-html/quarto.js"></script>
<script src="AD_Entrega1_files/libs/quarto-html/popper.min.js"></script>
<script src="AD_Entrega1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="AD_Entrega1_files/libs/quarto-html/anchor.min.js"></script>
<link href="AD_Entrega1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="AD_Entrega1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="AD_Entrega1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="AD_Entrega1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="AD_Entrega1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Análisis del Impacto del Mieloma Múltiple en los Niveles de Hemoglobina</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Marc Arrom Esquembre </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 16, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="datos" class="level2">
<h2 class="anchored" data-anchor-id="datos">Datos</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 23
  `original order` PATID PROT    AGE SEX   RACE  ISOTYPE   B2M   CRP CREAT   LDH
             &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1                1  8241 TT2    53.4 fema… white IgG       1.8   8.6   0.6   149
2                2  9843 TT2    52.7 fema… white IgG       1.7   8.9   0.6   144
3                3  9888 TT2    62.0 male  white Nonsec…   5.5   4.5   0.8   113
4                4  9835 TT2    60.3 male  white IgA       2.8   9.9   1     102
5                5  9997 TT2    66.9 male  white IgG       4     2.6   1.2   194
6                6  9992 TT2    55.3 fema… white IgA       2.9   2.1   1     146
# ℹ 12 more variables: ALB &lt;dbl&gt;, HGB &lt;dbl&gt;, ASPC &lt;chr&gt;, BMPC &lt;chr&gt;, MRI &lt;dbl&gt;,
#   CPS1 &lt;dbl&gt;, CPR1 &lt;dbl&gt;, EFS_Censor &lt;dbl&gt;, EFS_Time &lt;dbl&gt;, OS_Censor &lt;dbl&gt;,
#   OS_Time &lt;dbl&gt;, Cyto_Abn &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Los datos han sido aportados por el profesor del TFG. Se trata de una base de datos formada por pacientes con Mieloma Múltiple. El estudio de estos ha sido realizado por Marc Arrom Esquembre. El enlace al repositorio es el siguiente: https://github.com/MarcArrom11/AD_Entrega1</p>
</section>
<section id="resumen" class="level2">
<h2 class="anchored" data-anchor-id="resumen">Resumen</h2>
<p>En este documento, se analiza un conjunto de datos compuesto por individuos diagnosticados con Mieloma Múltiple, con el propósito de evaluar cómo esta enfermedad puede influir en los niveles de hemoglobina. Utilizando datos recopilados, se examina la proporción de pacientes que presentan niveles de hemoglobina fuera del rango normal establecido. Los resultados indican que un significativo porcentaje de los pacientes con Mieloma Múltiple muestra alteraciones en sus niveles de hemoglobina. Específicamente, hemos observado que el 65.9% de las mujeres y el 80.5% de los hombres se encuentran fuera de los rangos normales de hemoglobina. Estos hallazgos sugieren que el Mieloma Múltiple tiene una notable incidencia en la alteración de los niveles de hemoglobina, con una tendencia predominante hacia valores por debajo de los niveles normales. Esta información es crucial para entender mejor el impacto de la enfermedad y para guiar futuros estudios y tratamientos.</p>
</section>
<section id="objetivos" class="level2">
<h2 class="anchored" data-anchor-id="objetivos">Objetivos</h2>
<p>Queremos determinar si el Mieloma Múltiple afecta los niveles de hemoglobina en sangre. Para ello, a partir de un conjunto de datos de pacientes con esta enfermedad se estudiaran las proporciones de personas con niveles correctos y las personas con niveles alterados. Destacar que se realizará el estudio dividiendo los individuos por sexo, debido a que tienen niveles de hemoglobina distintos.</p>
</section>
<section id="contexto-y-variables-de-la-base-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="contexto-y-variables-de-la-base-de-datos">Contexto y variables de la base de datos</h2>
<p>Este dataset está formado por 565 observaciones pertenecientes a pacientes con Mieloma Múltiple (un tipo de cancer que se origina en la médula ósea). Cada obersvación cuenta con 23 variables, hagamos un pequeño repaso de estas y para aquellas variables cínicas, analicemos cuáles deberían ser los valores para una persona sana. Los datos han sido extraidos del portal MayoClínic.</p>
<ul>
<li><p>PATID. Nos indica la identifación del paciente.</p></li>
<li><p>PROT. Nos indica el tratamiento que se le aplicó al paciente, TT2 o TT3.</p></li>
<li><p>AGE. Nos indica la edad del paciente expresada en años.</p></li>
<li><p>SEX. Nos indica el sexo del paciente, “male” o “female”.</p></li>
<li><p>RACE. Nos indica la raza del paciente, “white” o “other”.</p></li>
<li><p>ISOTYPE. El isotipo del paciente, “IgA”, “IgG”, “IgM” o “IgE”.</p></li>
<li><p>B2M. Nos indica la Microglobulina beta-2, expresada en mg/l.La beta-2 microglobulina es una proteína que indica la función renal y el estado del sistema inmunológico. En el mieloma múltiple, sus niveles aumentan debido a la proliferación de células malignas y daño renal. Los niveles normales son inferiores a 2.5 mg/L.</p></li>
<li><p>CRP. La Proteína C-Reactiva es un marcador de inflamación producido en el hígado, cuyo nivel en sangre aumenta en respuesta a la inflamación. En el mieloma múltiple, puede elevarse debido a la inflamación y a las infecciones recurrentes, ya que los pacientes tienen un sistema inmunológico comprometido.</p></li>
<li><p>CREAT. Nos indica la creatinina, expresada en mg/dl. El rango normal para personas adulto s es entre 0,74 y 1,35m mg/dl para los hombres y entre 0,59 y 1,04 mg/dl.</p></li>
<li><p>LDH. Nos indica el Lactato Deshidrogenasa, expresado en U/l. La lactato deshidrogenasa es una enzima liberada en la sangre cuando hay daño celular. En el mieloma múltiple, sus niveles elevados indican mayor recambio celular y pueden reflejar una carga tumoral elevada o una enfermedad más agresiva. Los niveles normales en hombres de LDH se encuentran entre 122 a 222 U/L.</p></li>
<li><p>ALB. Nos indica la Albúmina, expresada en g/l. Nos indica la Albúmina, expresada en g/l. La albúmina es una proteína del hígado que regula el equilibrio de líquidos y transporta sustancias en el cuerpo. En el mieloma múltiple, sus niveles pueden reducirse por inflamación crónica, daño renal o mala nutrición. Los niveles normales de albúmina en adultos suelen estar entre 3.5 y 5.0 g/dL .</p></li>
<li><p>HGB. Nos indica la Hemoglobina, expresada en g/dl. Nos indica la Hemoglobina, expresada en g/dl. La hemoglobina es una proteína en los glóbulos rojos que transporta oxígeno a los tejidos. En el mieloma múltiple, los pacientes suelen tener anemia debido a que las células cancerosas en la médula ósea desplazan a las que producen glóbulos rojos, lo que reduce su producción y causa síntomas como fatiga y debilidad. Los niveles normales de hemoglobina se encuentran entre 13,2 a 16,6 g/dL para los hombres y 11,6 a 15 g/dL para las mujeres.</p></li>
<li><p>ASPC. Nos indica las Células plasmáticas en aspirado de médula ósea, se expresa como un porcentaje de las células malignas.</p></li>
<li><p>BMPC. Nos indica Células plasmáticas en biopsia de médula ósea, se como el porcentaje de células plasmáticas de biopsia presentes en la médula ósea.</p></li>
<li><p>MRI. Nos indica el número de lesiones focales definidas por resonancia magnéticaIndica el número de lesiones focales visibles en una resonancia magnética, que suelen estar presentes en huesos como el cráneo, la columna y la pelvis.</p></li>
<li><p>CPS1. Se trata de un parámetro clínico.</p></li>
<li><p>CPR1. Se trata de un parámetro clínico.</p></li>
<li><p>EFS_Censor. “Event-free survival censor” indica si un paciente ha sufrido recaída o progresión del mieloma múltiple. Si no ha ocurrido, el paciente se considera “censurado,” lo que significa que sigue sin complicaciones y en observación.</p></li>
<li><p>EFS_Time. “Event-free survival time” representa el tiempo de supervivencia libre de eventos (en meses), medido desde la fecha de registro hasta la muerte, progresión de la enfermedad o recaída, o censurado en la última fecha de contacto.</p></li>
<li><p>OS_Censor. Indica el estado de fallecimiento del paciente. Se marca como “1” si el paciente ha fallecido y “0” si no ha ocurrido la muerte, en cuyo caso el paciente se considera censurado en el estudio.</p></li>
<li><p>OS_Time. Indica el tiempo de supervivencia global en meses, calculado desde la fecha de registro hasta la fecha de muerte o censurado en la última fecha de contacto si no ha ocurrido el fallecimiento.</p></li>
<li><p>Cyto_Abn. Indica la presencia de anomalías citogenéticas. Se marca como “1” si se detectaron anomalías y “0” si no se detectaron o estaban ausentes.</p></li>
</ul>
</section>
<section id="visualización-y-análisis-de-los-datos" class="level2">
<h2 class="anchored" data-anchor-id="visualización-y-análisis-de-los-datos">Visualización y análisis de los datos</h2>
<p>Ahora se mostrarán los datos hemoglobina separados por sexo en un gráfico. En este se muestra un rango, de color verde, que indica el intervalo en que los niveles de hemoglobia se consideran normales.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AD_Entrega1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Observamos que, en ambos sexos, hay una gran cantidad de individuos por debajo de los niveles normales. Aquí se muestra una tabla con los valors filtrados.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  SEX    estado                      cantidad total porcentaje
  &lt;chr&gt;  &lt;chr&gt;                          &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;
1 female Dentro del rango normal           77   226      34.1 
2 female Por debajo del rango normal      146   226      64.6 
3 female Por encima del rango normal        3   226       1.33
4 male   Dentro del rango normal           66   339      19.5 
5 male   Por debajo del rango normal      272   339      80.2 
6 male   Por encima del rango normal        1   339       0.29</code></pre>
</div>
</div>
</section>
<section id="conclusiones" class="level2">
<h2 class="anchored" data-anchor-id="conclusiones">Conclusiones</h2>
<p>Observando la proporción de personas cuyos niveles de hemoglobina están fuera de los rangos normales, se evidencia que el 65.9% de las mujeres y el 80.5% de los hombres presentan niveles alterados. Este hallazgo sugiere que los individuos con Mieloma Múltiple tienen una tendencia significativa a presentar niveles de hemoglobina anormales, predominantemente por debajo de los valores normales. Estos resultados indican una posible asociación entre el Mieloma Múltiple y alteraciones en los niveles de hemoglobina, lo cual puede ser relevante para la evaluación y el manejo clínico de esta condición.</p>
</section>
<section id="bibliografia" class="level2">
<h2 class="anchored" data-anchor-id="bibliografia">Bibliografia</h2>
<ul>
<li><p>Mayo Clinic. (2023). <em>Información sobre los rangos “Normales” de creatinina y su relación con la Albúmina</em>. Retrieved from <a href="https://www.mayoclinic.org/es/tests-procedures/creatinine-test/about/pac-20384646">Mayo Clinic</a></p></li>
<li><p>Mayo Clinic. (2024). <em>Información sobre los rangos Albúmina y Lactato deshidrogenasa EN HOMBRES</em>. Retrieved from <a href="https://www.mayoclinic.org/es/tests-procedures/liver-function-tests/about/pac-20394595#:~:text=La%20L%2Dlactato%20deshidrogenasa%20es,Tiempo%20de%20protrombina.">Mayo Clinic</a></p></li>
<li><p>Mayo Clinic. (2022). <em>Información sobre rangos Normales de hemoglobina</em>. Retrieved from <a href="https://www.mayoclinic.org/es/tests-procedures/hemoglobin-test/about/pac-20385075">Mayo Clinic</a></p></li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>